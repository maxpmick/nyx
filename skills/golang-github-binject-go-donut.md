---
name: go-donut
description: Convert VBS, JS, PE, or .NET EXE/DLL files into position-independent shellcode for in-memory execution. Use when performing exploitation, red teaming, or post-exploitation to bypass security controls like AMSI/WLDP and execute payloads without touching disk.
---

# go-donut

## Overview
A pure Go implementation of the Donut generator. It creates shellcode payloads from various file types (VBS, JS, EXE, DLL, .NET assemblies) that can be injected into any Windows process. Category: Exploitation / Post-Exploitation.

## Installation (if not already installed)
Assume go-donut is already installed. If the command is missing:

```bash
sudo apt update && sudo apt install golang-github-binject-go-donut
```

## Common Workflows

### Convert a .NET EXE to x64 Shellcode
```bash
go-donut -i payload.exe -a x64 -o payload.bin
```

### Generate C-style Shellcode for a .NET DLL
Requires specifying the class and method to invoke.
```bash
go-donut -i Plugin.dll -c TestClass -m RunProcess -p "calc.exe" -f 3 -o loader.c
```

### Bypass AMSI and use Base64 Output
```bash
go-donut -i script.vbs -b 1 -f 2 -o script.txt
```

### Create Shellcode for a DLL with Unicode Parameters
```bash
go-donut -i target.dll -m ExportedFunc -p "argument" -w -o loader.bin
```

## Complete Command Reference

```
go-donut [Options] -i <input_file>
```

### Required Arguments

| Flag | Description |
|------|-------------|
| `-i`, `--in` | .NET assembly, EXE, DLL, VBS, JS or XSL file to execute in-memory |

### General Options

| Flag | Description |
|------|-------------|
| `-h`, `--help` | Print help information |
| `-v`, `--verbose` | Show verbose output |
| `-o`, `--out` | Output file (default: `loader.bin`) |
| `-f`, `--format` | Output format: 1=raw, 2=base64, 3=c, 4=ruby, 5=python, 6=powershell, 7=C#, 8=hex (default: 1) |
| `-a`, `--arch` | Target Architecture: x32, x64, or x84 (default: x84) |
| `-z`, `--compress` | Pack/Compress file: 1=disable, 2=LZNT1, 3=Xpress, 4=Xpress Huffman (default: 1) |

### Execution & Evasion Options

| Flag | Description |
|------|-------------|
| `-e`, `--entropy` | Entropy: 1=disable, 2=use random names, 3=random names + symmetric encryption (default: 3) |
| `-b`, `--bypass` | Bypass AMSI/WLDP: 1=skip, 2=abort on fail, 3=continue on fail (default: 3) |
| `-x`, `--exit` | Exiting behavior: 1=exit thread, 2=exit process (default: 1) |
| `-t`, `--thread` | Create new thread for entrypoint of unmanaged EXE |
| `-y`, `--oep` | Create a new thread for loader. Optionally execute original entrypoint of host process |

### .NET / DLL Specific Options

| Flag | Description |
|------|-------------|
| `-n`, `--module` | Module name. Randomly generated by default with entropy enabled |
| `-u`, `--url` | HTTP server that will host the donut module |
| `-c`, `--class` | Optional class name (required for .NET DLL) |
| `-d`, `--domain` | AppDomain name to create for .NET. Randomly generated by default with entropy enabled |
| `-m`, `--method` | Optional method or API name for DLL (required for .NET DLL) |
| `-p`, `--params` | Optional parameters/command line inside quotations for DLL method/function or EXE |
| `-w`, `--unicode` | Command line is passed to unmanaged DLL function in UNICODE format (default is ANSI) |
| `-r`, `--runtime` | CLR runtime version. This will override the auto-detected version |

## Notes
- **Architecture**: The `x84` architecture option typically refers to dual-mode shellcode that can run on both x86 and x64 systems.
- **AMSI Bypass**: The tool includes built-in bypasses for Antimalware Scan Interface (AMSI) and Windows Lockdown Policy (WLDP).
- **In-Memory**: Payloads generated by go-donut are designed to be executed entirely in memory, making them effective against traditional disk-based antivirus.