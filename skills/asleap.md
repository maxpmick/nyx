---
name: asleap
description: Actively recover LEAP and PPTP passwords by exploiting deficiencies in Cisco LEAP networks and MS-CHAPv2. Use when performing wireless security audits, attacking LEAP-enabled Wi-Fi networks, or recovering passwords from PPTP VPN captures.
---

# asleap

## Overview
asleap is a tool designed to demonstrate deficiencies in Cisco LEAP and PPTP networks. It recovers passwords by exploiting the MS-CHAPv2 authentication protocol used in these environments. It works by analyzing captured handshakes and performing high-speed dictionary attacks using pre-computed hashes. Category: Wireless Attacks.

## Installation (if not already installed)
Assume asleap is already installed. If the command is missing:

```bash
sudo apt update
sudo apt install asleap
```

## Common Workflows

### 1. Generate Lookup Files
Before cracking, use `genkeys` to create an index of hashes from a wordlist for rapid lookup.
```bash
genkeys -r /usr/share/wordlists/rockyou.txt -f leap.dat -n leap.idx
```

### 2. Crack from a Capture File
Analyze a pcap file containing a LEAP or PPTP exchange using the generated index files.
```bash
asleap -r capture.pcap -f leap.dat -n leap.idx
```

### 3. Crack Manual Challenge/Response
If you have the challenge and response values (e.g., from FreeRADIUS logs), you can crack them directly using a standard wordlist.
```bash
asleap -C 58:16:d5:ac:4b:dc:e4:0f -R 50:ae:a3:0a:10:9e:28:f9:33:1b:44:b1:3d:9e:20:91:85:e8:2e:c3:c5:4c:00:23 -W passwords.txt
```

### 4. Live Capture
Listen on a wireless interface to capture and crack handshakes in real-time.
```bash
asleap -i wlan0mon -f leap.dat -n leap.idx
```

## Complete Command Reference

### asleap
The main tool for password recovery.

| Flag | Description |
|------|-------------|
| `-r` | Read from a libpcap file |
| `-i` | Interface to capture on |
| `-f` | Dictionary file with NT hashes (generated by genkeys) |
| `-n` | Index file for NT hashes (generated by genkeys) |
| `-s` | Skip the check to make sure authentication was successful |
| `-h` | Output help information and exit |
| `-v` | Print verbose information (use multiple times for more verbosity) |
| `-V` | Print program version and exit |
| `-C` | Challenge value in colon-delimited bytes |
| `-R` | Response value in colon-delimited bytes |
| `-W` | ASCII dictionary file (special purpose/wordlist mode) |

### genkeys
Utility to generate the lookup and index files required by asleap for high-speed cracking.

| Flag | Description |
|------|-------------|
| `-r` | Input dictionary file, one word per line |
| `-f` | Output pass+hash filename |
| `-n` | Output index filename |
| `-h` | Last 2 hash bytes to filter with (optional) |

## Notes
- **Performance**: Using `genkeys` to pre-compute hashes significantly speeds up the cracking process compared to standard wordlist mode (`-W`).
- **LEAP Security**: Cisco LEAP is considered insecure because it transmits the username in cleartext and uses a challenge/response mechanism vulnerable to offline dictionary attacks.
- **PPTP**: This tool is also highly effective against PPTP VPNs that use MS-CHAPv2 for authentication.