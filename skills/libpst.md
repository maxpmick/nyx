---
name: libpst
description: A suite of tools for reading and converting Microsoft Outlook PST files into various formats like mbox, MH, KMail, LDIF, and DII. Use when performing digital forensics, email analysis, or data recovery from Outlook Personal Folders (.pst) files.
---

# libpst (pst-utils)

## Overview
libpst provides a library and a set of utilities (pst-utils) to access and export data from Microsoft Outlook PST files. It is essential for forensic investigations involving email archives, allowing conversion to open formats for analysis. Category: Digital Forensics / Respond.

## Installation (if not already installed)
Assume the tools are already installed. If commands are missing:

```bash
sudo apt update
sudo apt install pst-utils
```

## Common Workflows

### Convert PST to mbox format (Standard)
```bash
readpst -o ./output_dir/ evidence.pst
```
Converts the PST file into mbox format, preserving the folder structure within the output directory.

### List contents of a PST file
```bash
lspst -l evidence.pst
```
Lists emails including Date, CC, and BCC fields to quickly survey the archive contents.

### Extract contacts to LDIF for LDAP/Address Books
```bash
pst2ldif -b "dc=example,dc=com" evidence.pst > contacts.ldif
```

### Forensic extraction including deleted items
```bash
readpst -D -r -o ./recovery/ evidence.pst
```
Recursively exports all items, including those marked as deleted.

## Complete Command Reference

### readpst
Convert PST files to mbox and other formats.

| Flag | Description |
|------|-------------|
| `-V` | Display program version |
| `-C <charset>` | Character set for items with an unspecified character set |
| `-D` | Include deleted items in output |
| `-L <level>` | Set debug level: 1=debug, 2=info, 3=warn |
| `-M` | Write emails in the MH (rfc822) format |
| `-S` | Separate. Write emails in the separate format |
| `-a <list>` | Discard any attachment without an extension on the provided list |
| `-b` | Don't save RTF-Body attachments |
| `-c[v\|l]` | Set Contact output mode: `-cv` = VCard, `-cl` = Email list |
| `-d <file>` | Debug to file |
| `-e` | As with `-M`, but include extensions on output files |
| `-h` | Help screen |
| `-j <int>` | Number of parallel jobs to run |
| `-k` | KMail. Output in kmail format |
| `-m` | As with `-e`, but write .msg files also |
| `-o <dir>` | Output directory to write files to |
| `-q` | Quiet. Only print error messages |
| `-r` | Recursive. Output in a recursive format |
| `-t[eajc]` | Set output type list: `e`=email, `a`=attachment, `j`=journal, `c`=contact |
| `-u` | Thunderbird mode. Write extra .size and .type files |
| `-w` | Overwrite any output mbox files |
| `-8` | Output bodies in UTF-8 if available |

*Note: Only one of -M, -S, -e, -k, -m, -r should be specified.*

### lspst
List PST file data.

| Flag | Description |
|------|-------------|
| `-d <file>` | Debug to file (binary log; use `readlog` to print) |
| `-l` | Print Date, CC, and BCC fields (default is only From and Subject) |
| `-f <fmt>` | Select date format in ctime format (default: "%F %T") |
| `-h` | Help screen |
| `-V` | Display program version |

### pst2ldif
Extract contacts from a PST file in .ldif format.

| Flag | Description |
|------|-------------|
| `-V` | Display program version |
| `-b <base>` | Set the LDAP base value |
| `-c <class>` | Set the class of the LDAP objects (can be multiple) |
| `-d <file>` | Debug to file |
| `-h` | Help screen |
| `-l <line>` | Extra line to insert in the LDIF file for each contact |
| `-o` | Use old schema (default is new schema) |

### pst2dii
Extract email messages in Summation DII load format.

| Flag | Description |
|------|-------------|
| `-f <font>` | **Required.** Set the ttf-font-file |
| `-B <prefix>`| Set the bates prefix string |
| `-O <file>` | Set the dii load file output filename |
| `-V` | Display program version |
| `-b <num>` | Set the starting bates sequence number |
| `-c <hex>` | Specify bates stamp color (6 digit hex) |
| `-d <file>` | Debug to file |
| `-h` | Help screen |
| `-o <dir>` | Output directory to write files to |

## Notes
- `readpst` is the most commonly used tool in this suite for general forensic imaging of mailboxes.
- When using `-o` (output directory) with `readpst`, the tool changes the working directory *after* opening the PST file.
- The debug files generated by `-d` are often binary; use the `readlog` utility (if available) to parse them.