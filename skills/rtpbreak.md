---
name: rtpbreak
description: Detect, reconstruct, and analyze RTP sessions from network traffic or pcap files. It works independently of signaling protocols like SIP or H.323 and does not require RTCP packets. Use when performing VoIP security assessments, intercepting unencrypted voice traffic, or analyzing RTP streams for packet loss and jitter during penetration testing or vulnerability analysis.
---

# rtpbreak

## Overview
rtpbreak is a tool designed to detect and reconstruct RTP sessions from a sequence of packets. It outputs raw audio data and pcap files for each detected stream, which can then be analyzed using tools like Wireshark or SoX. It supports standard Ethernet and wireless (IEEE 802.11) networks. Category: Vulnerability Analysis / Sniffing & Spoofing.

## Installation (if not already installed)
Assume rtpbreak is already installed. If the command is missing:

```bash
sudo apt update
sudo apt install rtpbreak
```

## Common Workflows

### Live Interception on Interface
Sniff traffic on `eth0` in promiscuous mode, fill gaps caused by packet loss, and save the reconstructed streams to a specific directory:
```bash
rtpbreak -i eth0 -m -g -d ./voip_capture
```

### Offline Analysis of Pcap File
Analyze a pre-captured pcap file to extract RTP streams:
```bash
rtpbreak -r capture.pcap -d ./extracted_rtp
```

### Filtered RTP Extraction
Extract only RTP streams that use a specific payload type (e.g., 0 for PCMU/G.711) and use unprivileged UDP ports:
```bash
rtpbreak -r capture.pcap -y 0 -u -v
```

### Background Monitoring
Run as a daemon in the background, logging to syslog instead of stdout:
```bash
rtpbreak -i eth0 -D -F -d /var/log/rtp_streams
```

## Complete Command Reference

### Input Options
| Flag | Description |
|------|-------------|
| `-r <str>` | Read packets from pcap file `<str>` |
| `-i <str>` | Read packets from network interface `<str>` |
| `-L <int>` | Force datalink header length to `<int>` bytes |

### Output Options
| Flag | Description |
|------|-------------|
| `-d <str>` | Set output directory (default: current directory `.`) |
| `-w` | Disable RTP raw dumps (.raw files) |
| `-W` | Disable RTP pcap dumps (.pcap files) |
| `-g` | Fill gaps in RTP raw dumps (replaces lost packets with silence/padding) |
| `-n` | Dump noise packets |
| `-f` | Disable stdout logging |
| `-F` | Enable syslog logging |
| `-v` | Enable verbose output |

### Selection/Filtering Options
| Flag | Description |
|------|-------------|
| `-m` | Sniff packets in promiscuous mode |
| `-p <str>` | Add a custom pcap filter (e.g., "host 192.168.1.1") |
| `-e` | Expect even destination UDP ports only |
| `-u` | Expect unprivileged source/destination UDP ports (>1024) |
| `-y <int>` | Expect specific RTP payload type (e.g., 0, 8, 18) |
| `-l <int>` | Expect specific RTP payload length in bytes |
| `-t <float>` | Set packet timeout in seconds (default: 10.00) |
| `-T <float>` | Set pattern timeout in seconds (default: 0.25) |
| `-P <int>` | Set pattern packets count (default: 5) |

### Execution Options
| Flag | Description |
|------|-------------|
| `-Z <str>` | Run as specified user `<str>` |
| `-D` | Run in background (daemon mode); implies `-f` |

### Miscellaneous
| Flag | Description |
|------|-------------|
| `-k` | List known RTP payload types and exit |
| `-h` | Display help and usage information |

## Notes
- **Signal Handling**: You can trigger a status dump of current statistics by sending the `SIGUSR2` signal to the running process: `kill -SIGUSR2 <pid>`.
- **Reconstruction**: The tool generates separate files for each direction of a call. Look for matching source/destination IP pairs in the output directory.
- **Post-Processing**: Raw files generated by rtpbreak can often be converted to WAV using SoX: `sox -t raw -r 8000 -v 1 -c 1 -e u-law input.raw output.wav`.