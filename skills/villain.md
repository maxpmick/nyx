---
name: villain
description: A high-level C2 framework designed to handle multiple TCP socket and HoaxShell-based reverse shells. It allows for enhanced shell functionality and the ability to share sessions among connected sibling servers. Use during exploitation and post-exploitation phases to manage multiple reverse shells, bypass AV with HoaxShell payloads, and collaborate with other operators in a team server environment.
---

# villain

## Overview
Villain is a Command & Control (C2) framework that specializes in managing HoaxShell and TCP-based reverse shells. It supports multi-user collaboration by allowing instances to connect as "siblings," sharing shell access across the network. Category: Exploitation / Post-Exploitation.

## Installation (if not already installed)
Assume Villain is already installed. If the command is missing:

```bash
sudo apt update && sudo apt install villain
```

Dependencies: python3, python3-netifaces, python3-pycryptodome, python3-pyperclip, python3-requests.

## Common Workflows

### Start Villain with default settings
```bash
villain
```
Starts the team server on port 6501, HoaxShell on 8080, and TCP handler on 4443.

### Start with HTTPS for HoaxShell
```bash
villain -c cert.pem -k key.pem -x 443
```
Uses SSL certificates to encrypt HoaxShell communication, typically used to bypass basic network inspection.

### Connect to a Sibling Server (Inside the Console)
Once the Villain console is running, you can connect to another operator:
```bash
connect <IP_ADDRESS> <PORT>
```

### Generate a Payload (Inside the Console)
To generate a HoaxShell payload for a Windows target:
```bash
generate os=windows lhost=eth0
```

## Complete Command Reference

### Startup Options

| Flag | Description |
|------|-------------|
| `-h`, `--help` | Show the help message and exit |
| `-p`, `--port PORT` | Team server port for sibling connections (default: 6501) |
| `-x`, `--hoax-port HOAX_PORT` | HoaxShell server port (default: 8080 via http, 443 via https) |
| `-n`, `--reverse-tcp-port PORT` | Reverse TCP multi-handler port (default: 4443) |
| `-f`, `--file-smuggler-port PORT` | HTTP file smuggler server port (default: 8888) |
| `-i`, `--insecure` | Allows any Villain client (sibling server) to connect without verification prompts |
| `-c`, `--certfile CERTFILE` | Path to your SSL certificate (for HoaxShell https server) |
| `-k`, `--keyfile KEYFILE` | Path to the private key for your certificate (for HoaxShell https server) |
| `-v`, `--version` | Show program's version number and exit |
| `-q`, `--quiet` | Do not print the banner on startup |

### Internal Console Commands
Once the framework is running, the following commands are available within the interactive shell:

| Command | Description |
|---------|-------------|
| `generate` | Generate a payload for a specific OS/interface |
| `shells` | List and manage active shell sessions |
| `connect` | Connect to a sibling Villain instance |
| `siblings` | List connected sibling servers |
| `sessions` | Alias for shells; manage active connections |
| `upload` | Use the file smuggler to host files for download on targets |
| `alias` | Give a shell session a shorter, easier name |
| `kill` | Terminate a session or sibling connection |
| `help` | Display help for internal commands |

## Notes
- **HoaxShell**: This framework relies heavily on HoaxShell, which is an unconventional reverse shell implementation that often bypasses AV/EDR by using HTTP(S) as a transport medium.
- **Sibling Servers**: When two Villain instances connect, they synchronize shells. If Operator A gets a shell, Operator B can also interact with it.
- **Payloads**: Payloads generated by Villain are typically obfuscated PowerShell or Python scripts. Always ensure `lhost` is set to an IP reachable by the target.